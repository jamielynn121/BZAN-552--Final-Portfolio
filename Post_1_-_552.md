Post 1 - Board Games
================
Jamie McKinnon
December 1, 2018

Introduction
============

The board game industry is an 9.6 billion industry, globally as of 2016, and constantly growing. Game analysis is sought by both the publishers and consumers. BoardGameGeek.com allows users to add their colletion information, including price paid, their ranking, and number of plays of each game owned.

With sites like BGG.com making it available for hobbiest to publish their collections, data is readily available for publishers to evaluate groupings and clusters of games to potentially influence where to focus marketing for new games and kickstarter funding campaigns.

Data Pull
=========

All collection information is manually entered over time and is unique to an individuals account. Some accounts are made public, so their collection is viewable by others. To download a .csv of my personal collection, go to <https://boardgamegeek.com/collection/user/Astrodar?own=1&subtype=boardgame&ff=1> and click "owned" next to Download board games: above the table of games. This will initialize a download to your computer.

Data Read
=========

First, we read the data into R and look at which columns are majority missing values using the DataExplorer package. We remove those columns from our collection data.

``` r
collection <- read.csv("C:/Users/jamie/Documents/BZAN/BZAN-552--Final-Portfolio/collection.csv")
head(collection)
```

    ##            objectname objectid rating numplays weight own fortrade want
    ## 1           7 Wonders    68448    6.5        1      0   1        0    0
    ## 2     Above and Below   172818    8.0        2      0   1        0    0
    ## 3            Alhambra     6249    7.0        4      0   1        0    0
    ## 4  Android: Netrunner   124742    7.0        2      0   1        0    0
    ## 5       Arcadia Quest   155068    8.0        8      0   1        0    0
    ## 6 Arcadia Quest: Pets   188699    0.0       NA      0   1        0    0
    ##   wanttobuy wanttoplay prevowned preordered wishlist wishlistpriority
    ## 1         0          0         0          0        0                1
    ## 2         0          0         0          0        0                2
    ## 3         0          0         0          0        0                1
    ## 4         0          0         0          0        0                1
    ## 5         0          0         0          0        0                4
    ## 6         0          0         0          0        0                3
    ##            wishlistcomment comment conditiontext haspartslist
    ## 1              LP: 2016-01      NA            NA           NA
    ## 2              LP: 2016-03      NA            NA           NA
    ## 3              LP: 2017-01      NA            NA           NA
    ## 4 LP: 2017-06\n\nJ - likes      NA            NA           NA
    ## 5                               NA            NA           NA
    ## 6                               NA            NA           NA
    ##   wantpartslist   collid baverage average avgweight rank numowned
    ## 1            NA 31735732  7.69975 7.78972    2.3405   44    85429
    ## 2            NA 33196748  7.27584 7.53674    2.5474  173    14293
    ## 3            NA 31739252  6.93236 7.03274    2.1150  410    29006
    ## 4            NA 31735716  7.72281 7.90829    3.3656   43    37162
    ## 5            NA 44224996  7.45799 7.85173    2.5128   94    11951
    ## 6            NA 52920074  6.17986 8.51354    2.0000    0     2694
    ##   objecttype        originalname minplayers maxplayers playingtime
    ## 1      thing           7 Wonders          2          7          30
    ## 2      thing     Above and Below          2          4          90
    ## 3      thing            Alhambra          2          6          60
    ## 4      thing  Android: Netrunner          2          2          45
    ## 5      thing       Arcadia Quest          2          4          60
    ## 6      thing Arcadia Quest: Pets          2          4         120
    ##   maxplaytime minplaytime yearpublished bggrecplayers bggbestplayers
    ## 1          30          30          2010     3,4,5,6,7              4
    ## 2          90          90          2015         2,3,4              3
    ## 3          60          45          2003       2,3,4,5              3
    ## 4          45          45          2012             2              2
    ## 5          60          60          2014         2,3,4              4
    ## 6         120          60          2017         2,3,4              4
    ##   bggrecagerange
    ## 1            10+
    ## 2            10+
    ## 3             8+
    ## 4            12+
    ## 5            10+
    ## 6               
    ##                                              bgglanguagedependence
    ## 1                                        No necessary in-game text
    ## 2 Extensive use of text - massive conversion needed to be playable
    ## 3                                        No necessary in-game text
    ## 4 Extensive use of text - massive conversion needed to be playable
    ## 5            Moderate in-game text - needs crib sheet or paste ups
    ## 6                                                                 
    ##   publisherid imageid year language other   itemtype barcode pricepaid
    ## 1          NA      NA   NA       NA    NA standalone      NA        NA
    ## 2          NA      NA   NA       NA    NA standalone      NA        NA
    ## 3          NA      NA   NA       NA    NA standalone      NA        NA
    ## 4          NA      NA   NA       NA    NA standalone      NA        NA
    ## 5          NA      NA   NA       NA    NA standalone      NA     79.99
    ## 6          NA      NA   NA       NA    NA  expansion      NA     46.99
    ##   pp_currency currvalue cv_currency acquisitiondate acquiredfrom quantity
    ## 1                    NA          NA                                    NA
    ## 2                    NA          NA                                    NA
    ## 3                    NA          NA      2014-07-12 Nicole Quist       NA
    ## 4                    NA          NA                                    NA
    ## 5         USD        NA          NA      2018-07-14  Sci-Fi City       NA
    ## 6         USD        NA          NA      2018-07-14  Sci-Fi City       NA
    ##             privatecomment invlocation invdate version_publishers
    ## 1 Pre-Marriage Acquisition          NA      NA                   
    ## 2      Won at Andocon 2015          NA      NA                   
    ## 3                     Gift          NA      NA                   
    ## 4 Pre-Marriage Acquisition          NA      NA                   
    ## 5                                   NA      NA                   
    ## 6                                   NA      NA                   
    ##   version_languages version_yearpublished version_nickname
    ## 1                                      NA                 
    ## 2                                      NA                 
    ## 3                                      NA                 
    ## 4                                      NA                 
    ## 5                                      NA                 
    ## 6                                      NA

``` r
DataExplorer::plot_missing(collection)
```

![](Post_1_-_552_files/figure-markdown_github/Read%20Data-1.png)

``` r
remove_cols <- c("quantity", "version_yearpublished", "invdate", "invlocation", "cv_currency", "currvalue", "barcode", "other", "language", "year", "imageid" , "publisherid", "wantpartslist", "haspartslist", "conditiontext", "comment")

collection <- collection[ , !(names(collection) %in% remove_cols)]
```

Data Insight
============

Because this data is based on my personal game collection, the set isn't very large. I own 167 unique games and expansions. However, because I track number of plays to determine how many games I've played in a year, I don't track expansion plays when they are used in conjunction with the base game.

To perform cluster analysis, I am intersted in the continuous variables only that I think would play a roll in clustering board games.

Unfortunately, a lot of my collection were gifts and I dont have the price paid for half of my collection. I am interested in clustering based on price and number of plays but in conjunction, there are few games that overlap to produce good clusters.

Data Subsets
============

I separate into two data subsets and I will perform separate cluster analysis on the two data subsets - (1) with price paid and without number of plays (2) with number of plays and without price plid.

``` r
# Continuous variables only
continuous <- c("rating", "numplays", "baverage", "minplayers", "maxplayers", "playingtime", "pricepaid")
col_cont <- collection[continuous]

# DATA SUBSETS

##------------##
## Price Paid ##
##------------##
# Where we know the price paid
summary(collection$pricepaid)
```

    ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
    ##    5.99   14.93   18.80   27.23   34.60  129.99      83

``` r
known_price <- collection[which(!is.na(collection$pricepaid)),]
pri_cont <- known_price[continuous]

## How many na values do we have in this data
sum(sapply(pri_cont, is.na))
```

    ## [1] 36

``` r
sum(sapply(pri_cont, is.infinite))
```

    ## [1] 0

``` r
sum(sapply(pri_cont, is.nan))
```

    ## [1] 0

``` r
# There are too many NA values in num plays for the data set where we know the price paid - so we can remove that column
pri_cont <- pri_cont[,-which(names(pri_cont) == "numplays")]
sum(sapply(pri_cont, is.na))
```

    ## [1] 0

``` r
##--------------##
## Number Plays ##
##--------------##
# Games we've played
# Expansions to games are never marked as "played" unless they can be played as a stand-alone game
num_plays <- collection[which(!is.na(collection$numplays)),]
play_cont <- num_plays[continuous]

## How many na values do we have in this data
sum(sapply(play_cont, is.na))
```

    ## [1] 41

``` r
sum(sapply(play_cont, is.infinite))
```

    ## [1] 0

``` r
sum(sapply(play_cont, is.nan))
```

    ## [1] 0

``` r
# There are too many NA values in price paid for the data set where we know the number of plays - so we can remove that column
play_cont <- play_cont[,-which(names(play_cont) == "pricepaid")]
sum(sapply(play_cont, is.na))
```

    ## [1] 0

Hierarchical Agglomerative Clustering with Price Data Subset
============================================================

First, I perform agglomerative (bottom up) clustering on my price data subset. I noticed after my first run that if a personal rating for that game did not exist then it was marked zero, rather than NA. So I reduce the data subset to not include unrated games.

I ensure there are no NA, infiniate, or NaN values in the data set and only use complete cases in my analysis. This reduced set is 61 observations, compared to 167 observations from the full collection. The data is scaled to standardize all variables. This ensures one column is not weighted much higher than another column due to original scale of the data and change in values.

There are multiple methods that can be used in hierarchical clustering. Here, I assess the average, single ,complete, and ward methods to determine which method has the highest agglomerative coefficient (AC). The AC measures the strength of the clustering structure. The closer the cluster structure is to 1, the better. Here, the ward method provides the highest AC; therefore, this is the method I choose to proceed with in my clustering.

To determine the optimal number of clusters, I use the silhouette calculation that produces a plot of the number of clusters versus the average sihoulette width. The average sihouette method measure the quality of clustering, similar to the agglomerative coefficient used above. Used together, we can determine how well each object lies within its respective cluster. A high average sihouette indicates good clustering. Three is determined to be the optimal number of clusters, as it produces the highest average sihouette width.

Finally, building my fit, I use the euclidean distance as the metric for measuring distance between elements to be merged and the ward.D2 method to lead to the minimum increase in total within-cluster variance after merging. Usually, the closest elements by distance that minimize the total within-cluster variance are merged to create a new cluster. This step is repeated for all points until they all join to one at the very top of the dendogram.

``` r
# BGG changes ratings to 0 if they haven't been rated
# Must change these to NAs
pri_cont <- pri_cont[which(!pri_cont$rating == "0"),]

# How many na values do we have in this data
sum(sapply(pri_cont, is.na))
```

    ## [1] 0

``` r
sum(sapply(pri_cont, is.infinite))
```

    ## [1] 0

``` r
sum(sapply(pri_cont, is.nan))
```

    ## [1] 0

``` r
# Keep only complete classes
pri_cont_complete <- pri_cont[complete.cases(pri_cont),]

# Standardize all variables
pri_cont_scale  <- scale(pri_cont_complete)

# Which method is most appropriate for clustering? 
m <- c( "average", "single", "complete", "ward")
names(m) <- c( "average", "single", "complete", "ward")

# Function to compute agglomerative coefficient - measures the amount of clustering structure found
ac <- function(x) {
  agnes(pri_cont_scale, method = x, metric = "euclidean")$ac
}

map_dbl(m, ac)
```

    ##   average    single  complete      ward 
    ## 0.8668924 0.8699946 0.8921362 0.9155601

``` r
# Determine Optimal Number of Clusters - Three is determined to be best by the silhouette calculation
fviz_nbclust(pri_cont_scale, hcut, method = "silhouette", hc_method = "ward.D2")
```

![](Post_1_-_552_files/figure-markdown_github/Hierarchical%20Price-1.png)

``` r
d <- dist(pri_cont_scale, method = "euclidian") # distance matrix
fit <- hclust(d, method="ward.D2")

## Display Dendogram ##
avg_dend_obj <- as.dendrogram(fit)
avg_col_dend <- color_branches(avg_dend_obj, h = 10)
plot(avg_col_dend)
```

![](Post_1_-_552_files/figure-markdown_github/Hierarchical%20Price-2.png)

Three Clusters on Price Data Subset
===================================

I cut the into three clusters, as determined optimal, and add that cluster ID back into the original data for further analysis. First, I summarize the clusters by mean values of each continuous variable to see how the clusters are different.

The three clusters have very different average price points and playing times. The max players and min players are, however, very similar. Cluster 1 seems to have higher ratings, higher playing times and higher price paid. While cluster 2 seems to be middle ground between 1 and 3. Cluster three is made up of 1 game that is an outlier in the data with a very low rating and very low price that plays very quickly.

Then, we can look at the game names and other statistics that were not used in the cluster analysis. Upon looking at the name of the games in each respective cluster, it is obvious to me why they were grouped like this. Cluster 1 includes some of my favorite games, games I was willing to pay a lot more for and that take a longer time to play. The ratings are highest because they are the games I have enjoyed the most in my collection. Cluster 2 includes a lot of games I really enjoy, but they play a little quicker and I haven't paid nearly as much for these games. Cluster 3 is a game, Zombie Dice, I got from a sale on International Table Top day. The sale was really good and my price paid was really low. Overall, the game was okay, but it isn't one that hits the table a lot anymore.

``` r
# cluster ID for each observation when cutting tree into 3 clusters
k3 <- cutree(fit, k=3) 

k3 <- as.factor(k3)
length(k3)
```

    ## [1] 61

``` r
nrow(pri_cont_complete)
```

    ## [1] 61

``` r
# Add the cluster number as a column in my data so we can group by
pri_cont_complete$k3 <- k3

pri_cont_complete %>%
  group_by(k3) %>%
  summarise_all("mean")
```

    ## # A tibble: 3 x 7
    ##   k3    rating baverage minplayers maxplayers playingtime pricepaid
    ##   <fct>  <dbl>    <dbl>      <dbl>      <dbl>       <dbl>     <dbl>
    ## 1 1       8.42     7.68       1.63       4.58       107       54.7 
    ## 2 2       7.28     6.70       1.85       4.56        46.6     20.7 
    ## 3 3       4.00     6.11       2.00      99.0         20.0      7.99

``` r
# Add the cluster number back into the original dataset for easy distinction
known_price_complete <- known_price[which(!known_price$rating == "0"),]
nrow(known_price_complete)
```

    ## [1] 61

``` r
known_price_complete$k3 <- k3

# Games in cluster 1
known_price_complete$objectname[which(known_price_complete$k3 == 1)]
```

    ##  [1] Arcadia Quest                         
    ##  [2] The Castles of Burgundy               
    ##  [3] Concordia                             
    ##  [4] Five Tribes                           
    ##  [5] Fury of Dracula (third/fourth edition)
    ##  [6] Gloomhaven                            
    ##  [7] Imperial Settlers                     
    ##  [8] Istanbul                              
    ##  [9] Kemet                                 
    ## [10] Massive Darkness                      
    ## [11] Mechs vs. Minions                     
    ## [12] OrlÃ©ans                              
    ## [13] Race for the Galaxy                   
    ## [14] Raiders of the North Sea              
    ## [15] Scythe                                
    ## [16] Scythe: Invaders from Afar            
    ## [17] Star Wars: Armada                     
    ## [18] Terraforming Mars                     
    ## [19] Viticulture Essential Edition         
    ## 167 Levels: 7 Wonders ... Zombie Dice

``` r
table(known_price_complete$itemtype[which(known_price_complete$k3 == 1)])
```

    ## 
    ##  expansion standalone 
    ##          1         18

``` r
table(droplevels(known_price_complete$acquiredfrom[which(known_price_complete$k3 == 1)]))
```

    ## 
    ##                                      Amazon          CoolStuffInc 
    ##                     1                     2                     3 
    ##      Coolstuffinc.com           Kickstarter            Riot Games 
    ##                     7                     1                     1 
    ##           Sci-Fi City Sci-Fi City Knoxville      The Raven's Nest 
    ##                     1                     2                     1

``` r
#known_price_complete[which(known_price_complete$k3 == 1),]

# Games in cluster 2
known_price_complete$objectname[which(known_price_complete$k3 == 2)]
```

    ##  [1] Bohnanza                                                       
    ##  [2] Carcassonne                                                    
    ##  [3] Castle Panic: The Wizard's Tower                               
    ##  [4] Century: Golem Edition                                         
    ##  [5] Colt Express                                                   
    ##  [6] Diamant                                                        
    ##  [7] Dice City                                                      
    ##  [8] Doctor Who Fluxx                                               
    ##  [9] Dogs of War                                                    
    ## [10] Dominion Big Box (English)                                     
    ## [11] Escape: The Curse of the Temple â€“ Big Box                    
    ## [12] Ethnos                                                         
    ## [13] Explorers of the North Sea                                     
    ## [14] Five Crowns                                                    
    ## [15] Forbidden Island                                               
    ## [16] The Fox in the Forest                                          
    ## [17] Guillotine                                                     
    ## [18] Hive Pocket                                                    
    ## [19] Imhotep                                                        
    ## [20] Imperial Settlers: Aztecs                                      
    ## [21] Imperial Settlers: Why Can't We Be Friends                     
    ## [22] Jaipur                                                         
    ## [23] Kingdomino                                                     
    ## [24] Love Letter                                                    
    ## [25] Magic Maze                                                     
    ## [26] Munchkin Zombies                                               
    ## [27] Mystic Vale                                                    
    ## [28] Mystic Vale: Vale of Magic                                     
    ## [29] Mystic Vale: Vale of the Wild                                  
    ## [30] Onitama                                                        
    ## [31] Photosynthesis                                                 
    ## [32] Smash Up                                                       
    ## [33] Smash Up: Cease and Desist                                     
    ## [34] Smash Up: Monster Smash                                        
    ## [35] Tak                                                            
    ## [36] Thief's Market                                                 
    ## [37] Ticket to Ride                                                 
    ## [38] Ticket to Ride Map Collection: Volume 2 â€“ India & Switzerland
    ## [39] Tiny Epic Galaxies: Beyond the Black                           
    ## [40] Unlock! The Formula                                            
    ## [41] Why First?                                                     
    ## 167 Levels: 7 Wonders ... Zombie Dice

``` r
table(known_price_complete$itemtype[which(known_price_complete$k3 == 2)])
```

    ## 
    ##  expansion standalone 
    ##          7         34

``` r
table(droplevels(known_price_complete$acquiredfrom[which(known_price_complete$k3 == 2)]))
```

    ## 
    ##                                      Amazon          CoolStuffInc 
    ##                     1                    19                     5 
    ##      Coolstuffinc.com             McGuire's       MiniatureMarket 
    ##                     8                     1                     1 
    ## Sci-Fi City Knoxville 
    ##                     6

``` r
#known_price_complete[which(known_price_complete$k3 == 2),]

# Games in cluster 3
known_price_complete$objectname[which(known_price_complete$k3 == 3)]
```

    ## [1] Zombie Dice
    ## 167 Levels: 7 Wonders ... Zombie Dice

``` r
known_price_complete$itemtype[which(known_price_complete$k3 == 3)]
```

    ## [1] standalone
    ## Levels: expansion standalone

``` r
known_price_complete$acquiredfrom[which(known_price_complete$k3 == 3)]
```

    ## [1] Amazon
    ## 22 Levels:  AEG Amazon Barnes and Noble ... The Raven's Nest

``` r
#known_price_complete[which(known_price_complete$k3 == 3),]
```

K-means Clustering on Price Data Subset
=======================================

K-means clustering was my second choice, due to known outliers in the dataset. I wanted to see how the clusters fit in reduced dimensions to see if this method was appropriate.

K-means clustering is found to work well when the shape of the clusters is hyper-spherical like circle in 2D. K-means clustering requries you know the number of clusters to intialize the fit. Furthermore, it does not do well when there are outliers in the cluster.

Wards method for hierarchical clustering is the hierarchical analog of K-means and can be used to initalize a k-means cluster. So here, I initilaize the kmeans fit with three clusters.

By plotting the clusters after kmeans, we see that Zombie Dice (game 167) is still an outlier in this data set, but not included in a cluster by itself like it was above in cluster 3 in the hierarchical method. Instead, it skews cluster 3 from the kmeans method and is very different from the centroid of that cluster.

``` r
set.seed(552)

fit <- kmeans(pri_cont_scale, 3)
fit         # print all available components
```

    ## K-means clustering with 3 clusters of sizes 2, 19, 40
    ## 
    ## Cluster means:
    ##        rating   baverage minplayers  maxplayers playingtime  pricepaid
    ## 1 -0.05588165  1.0113238 -1.4275770 -0.09154877   2.2112627  3.7111223
    ## 2  0.75146113  0.8021241 -0.3772435 -0.13044991   0.9608536  0.4868064
    ## 3 -0.35414995 -0.4315751  0.2505695  0.06654115  -0.5669686 -0.4167892
    ## 
    ## Clustering vector:
    ##   5  19  22  27  29  34  38  39  44  45  47  48  49  50  51  53  55  56 
    ##   2   3   3   2   2   3   3   2   3   3   3   3   3   3   3   3   3   2 
    ##  58  59  60  62  64  65  68  69  71  72  73  74  76  81  83  85  87  88 
    ##   3   3   2   1   3   3   3   2   2   2   3   3   2   3   3   3   1   2 
    ##  91  92  94  95  97  98  99 102 103 110 111 122 123 124 130 144 145 148 
    ##   3   3   3   3   3   2   3   2   2   2   2   3   3   3   2   3   2   3 
    ## 149 150 152 157 162 165 167 
    ##   3   3   3   3   2   3   3 
    ## 
    ## Within cluster sum of squares by cluster:
    ## [1]   8.025667  57.567637 167.950324
    ##  (between_SS / total_SS =  35.1 %)
    ## 
    ## Available components:
    ## 
    ## [1] "cluster"      "centers"      "totss"        "withinss"    
    ## [5] "tot.withinss" "betweenss"    "size"         "iter"        
    ## [9] "ifault"

``` r
fit$center  # centers of each variable
```

    ##        rating   baverage minplayers  maxplayers playingtime  pricepaid
    ## 1 -0.05588165  1.0113238 -1.4275770 -0.09154877   2.2112627  3.7111223
    ## 2  0.75146113  0.8021241 -0.3772435 -0.13044991   0.9608536  0.4868064
    ## 3 -0.35414995 -0.4315751  0.2505695  0.06654115  -0.5669686 -0.4167892

``` r
fit$cluster # cluster ID for each observation
```

    ##   5  19  22  27  29  34  38  39  44  45  47  48  49  50  51  53  55  56 
    ##   2   3   3   2   2   3   3   2   3   3   3   3   3   3   3   3   3   2 
    ##  58  59  60  62  64  65  68  69  71  72  73  74  76  81  83  85  87  88 
    ##   3   3   2   1   3   3   3   2   2   2   3   3   2   3   3   3   1   2 
    ##  91  92  94  95  97  98  99 102 103 110 111 122 123 124 130 144 145 148 
    ##   3   3   3   3   3   2   3   2   2   2   2   3   3   3   2   3   2   3 
    ## 149 150 152 157 162 165 167 
    ##   3   3   3   3   2   3   3

``` r
fviz_cluster(fit, data = pri_cont_scale, palette = "Set2", ggtheme = theme_minimal())
```

![](Post_1_-_552_files/figure-markdown_github/Kmeans%20Price-1.png)

``` r
# Determine number of clusters with SSE
SSEs <- rep(NA,10) # a vector to store SSEs for different k's
SSEs[1] <- fit$totss # total SSE if no clustering is done
for(k in 2:10){
    fit <- kmeans(pri_cont_scale,k)
    SSEs[k] <- fit$tot.withinss
}
par(mar=c(4,4,1,1))

plot(1:10,SSEs,type="b",xlab="Number of Clusters")
```

![](Post_1_-_552_files/figure-markdown_github/Kmeans%20Price-2.png)

Hierarchical Agglomerative Clustering with Number of Plays
==========================================================

All techniques for clustering were duplicated from the hierarchical analysis above. Therefore, I will only explain the differences I see in the output of the clusters.

``` r
# BGG changes ratings to 0 if they haven't been rated
# Must change these to NAs
play_cont <- play_cont[which(!play_cont$rating == "0"),]


# How many na values do we have in this data
sum(sapply(play_cont, is.na))
```

    ## [1] 0

``` r
sum(sapply(play_cont, is.infinite))
```

    ## [1] 0

``` r
sum(sapply(play_cont, is.nan))
```

    ## [1] 0

``` r
# Keep only complete classes
play_cont_complete <- play_cont[complete.cases(play_cont),]

# standardize all variables
play_cont_scale  <- scale(play_cont_complete)

## Which method is most appropriate for clustering? ##
# Methods to assess
m <- c( "average", "single", "complete", "ward")
names(m) <- c( "average", "single", "complete", "ward")

# Function to compute agglomerative coefficient
# Measures the amount of clustering structure found
ac <- function(x) {
  agnes(play_cont_scale, method = x, metric = "euclidean")$ac
}

map_dbl(m, ac)
```

    ##   average    single  complete      ward 
    ## 0.8643384 0.8539395 0.9020785 0.9283144

``` r
## Determine Optimal Number of Clusters ##
fviz_nbclust(play_cont_scale, hcut, method = "silhouette", hc_method = "ward.D2")
```

![](Post_1_-_552_files/figure-markdown_github/Hierarchical%20Number%20of%20Plays-1.png)

``` r
# Three is determined to be best by the silhouette calculation

d <- dist(play_cont_scale, method = "euclidian") # distance matrix
fit <- hclust(d, method="ward.D2")

## Display Dendogram ##
avg_dend_obj <- as.dendrogram(fit)
avg_col_dend <- color_branches(avg_dend_obj, h = 13)
plot(avg_col_dend)
```

![](Post_1_-_552_files/figure-markdown_github/Hierarchical%20Number%20of%20Plays-2.png)

Three Clusters on Number of Plays Data Subset
=============================================

I performed the same type of clustering as the hierarchical method above with the price paid column. Here, cluster 2 represents similar games with some overlap as cluster 1 from the first hierarchical model. These are games with high ranking, high number of plays, and long playing times. These also seem to have a lower average player count. This makes sense because a lot of the games I enjoy playing are with small groups of 2-4 to allow the most interactivity. Cluster 3 is the same as before, low price and low ratings. It includes one more game than before that was left out of the last subset. These are both games that rarely hit the table, and are pretty quick party games for large groups of people. I purchased these games specifically for that purpose of large group play and social events. I prefer heavy board games to light board games which is why these are generally ranked lower. Cluster 1 is that middle group with games I enjoy, but arn't my favorite.

``` r
# cluster ID for each observation when cutting tree into 3 clusters
k3 <- cutree(fit, k=3) 

k3 <- as.factor(k3)
length(k3)
```

    ## [1] 88

``` r
nrow(play_cont_complete)
```

    ## [1] 88

``` r
# Add the cluster number as a column in my data so we can group by
play_cont_complete$k3 <- k3

play_cont_complete %>%
  group_by(k3) %>%
  summarise_all("mean")
```

    ## # A tibble: 3 x 7
    ##   k3    rating numplays baverage minplayers maxplayers playingtime
    ##   <fct>  <dbl>    <dbl>    <dbl>      <dbl>      <dbl>       <dbl>
    ## 1 1       6.82     7.48     6.77       2.04       5.35        44.3
    ## 2 2       8.41    13.2      7.71       1.59       4.47       115  
    ## 3 3       3.00     4.00     5.87       2.50      99.0         17.5

``` r
num_plays_complete <- num_plays[which(!num_plays$rating == "0"),]
nrow(num_plays_complete)
```

    ## [1] 88

``` r
num_plays_complete$k3 <- k3

# Games in cluster 1
num_plays_complete$objectname[which(num_plays_complete$k3 == 1)]
```

    ##  [1] 7 Wonders                                                
    ##  [2] Above and Below                                          
    ##  [3] Alhambra                                                 
    ##  [4] Android: Netrunner                                       
    ##  [5] Arcadia Quest                                            
    ##  [6] Bananagrams                                              
    ##  [7] Bananagrams Party                                        
    ##  [8] BANG! The Dice Game                                      
    ##  [9] Bohnanza                                                 
    ## [10] Camel Up                                                 
    ## [11] Carcassonne                                              
    ## [12] Castle Panic                                             
    ## [13] Catan                                                    
    ## [14] Caverna: Cave vs Cave                                    
    ## [15] Celestia                                                 
    ## [16] Century: Golem Edition                                   
    ## [17] Citadels                                                 
    ## [18] Codenames                                                
    ## [19] Colt Express                                             
    ## [20] Cranium                                                  
    ## [21] Dark Seas                                                
    ## [22] Diamant                                                  
    ## [23] Dice City                                                
    ## [24] Doctor Who Fluxx                                         
    ## [25] Dogs of War                                              
    ## [26] Ethnos                                                   
    ## [27] Explorers of the North Sea                               
    ## [28] Farkle                                                   
    ## [29] Five Tribes                                              
    ## [30] Forbidden Desert                                         
    ## [31] Forbidden Island                                         
    ## [32] The Fox in the Forest                                    
    ## [33] A Game of Thrones: Hand of the King                      
    ## [34] Guillotine                                               
    ## [35] Hive Pocket                                              
    ## [36] I Hate Zombies                                           
    ## [37] Imhotep                                                  
    ## [38] Istanbul                                                 
    ## [39] Jaipur                                                   
    ## [40] King of Tokyo                                            
    ## [41] Kingdom Builder                                          
    ## [42] Kingdomino                                               
    ## [43] Love Letter                                              
    ## [44] Love Letter: The Hobbit â€“ The Battle of the Five Armies
    ## [45] Magic Maze                                               
    ## [46] Mystic Vale                                              
    ## [47] Ninja Dice                                               
    ## [48] Onitama                                                  
    ## [49] Photosynthesis                                           
    ## [50] Pictomania                                               
    ## [51] Quiddler                                                 
    ## [52] Race for the Galaxy                                      
    ## [53] Roll for the Galaxy                                      
    ## [54] Rummikub                                                 
    ## [55] Secret Hitler                                            
    ## [56] Shadows over Camelot                                     
    ## [57] Sheriff of Nottingham                                    
    ## [58] Small World                                              
    ## [59] Smash Up                                                 
    ## [60] Splendor                                                 
    ## [61] A Study in Emerald (second edition)                      
    ## [62] Tak                                                      
    ## [63] Tetris Link                                              
    ## [64] Thief's Market                                           
    ## [65] Ticket to Ride                                           
    ## [66] Tiny Epic Galaxies                                       
    ## [67] Tiny Epic Western                                        
    ## [68] Unlock! The Formula                                      
    ## [69] Why First?                                               
    ## 167 Levels: 7 Wonders ... Zombie Dice

``` r
table(num_plays_complete$itemtype[which(num_plays_complete$k3 == 1)])
```

    ## 
    ##  expansion standalone 
    ##          0         69

``` r
table(droplevels(num_plays_complete$acquiredfrom[which(num_plays_complete$k3 == 1)]))
```

    ## 
    ##                                       
    ##                                    30 
    ##                                Amazon 
    ##                                    13 
    ##                          CoolStuffInc 
    ##                                     3 
    ##                      Coolstuffinc.com 
    ##                                    10 
    ## Garrett Christmas White Elephant 2017 
    ##                                     1 
    ##                                 Jamie 
    ##                                     1 
    ##                           Kickstarter 
    ##                                     2 
    ##                       MiniatureMarket 
    ##                                     1 
    ##                          Nicole Quist 
    ##                                     1 
    ##                          Raven's Nest 
    ##                                     3 
    ##                           Sci-Fi City 
    ##                                     1 
    ##                 Sci-Fi City Knoxville 
    ##                                     3

``` r
# Games in cluster 2
num_plays_complete$objectname[which(num_plays_complete$k3 == 2)]
```

    ##  [1] Blood Rage                                      
    ##  [2] The Castles of Burgundy                         
    ##  [3] Concordia                                       
    ##  [4] Dead of Winter: A Crossroads Game               
    ##  [5] Fury of Dracula (third/fourth edition)          
    ##  [6] Gloomhaven                                      
    ##  [7] Imperial Settlers                               
    ##  [8] Kemet                                           
    ##  [9] Massive Darkness                                
    ## [10] Mechs vs. Minions                               
    ## [11] OrlÃ©ans                                        
    ## [12] Raiders of the North Sea                        
    ## [13] Robinson Crusoe: Adventures on the Cursed Island
    ## [14] Scythe                                          
    ## [15] Star Wars: Armada                               
    ## [16] Terraforming Mars                               
    ## [17] Viticulture Essential Edition                   
    ## 167 Levels: 7 Wonders ... Zombie Dice

``` r
table(num_plays_complete$itemtype[which(num_plays_complete$k3 == 2)])
```

    ## 
    ##  expansion standalone 
    ##          0         17

``` r
table(droplevels(num_plays_complete$acquiredfrom[which(num_plays_complete$k3 == 2)]))
```

    ## 
    ##                                      Amazon    BoardGameBliss.com 
    ##                     1                     3                     1 
    ##          CoolStuffInc      Coolstuffinc.com           Kickstarter 
    ##                     2                     5                     1 
    ##          Raven's Nest            Riot Games Sci-Fi City Knoxville 
    ##                     1                     1                     1 
    ##      The Raven's Nest 
    ##                     1

``` r
#num_plays_complete[which(num_plays_complete$k3 == 2),]

# Games in cluster 3
num_plays_complete$objectname[which(num_plays_complete$k3 == 3)]
```

    ## [1] Who Would Win Zombie Dice  
    ## 167 Levels: 7 Wonders ... Zombie Dice

``` r
table(num_plays_complete$itemtype[which(num_plays_complete$k3 == 3)])
```

    ## 
    ##  expansion standalone 
    ##          0          2

``` r
table(droplevels(num_plays_complete$acquiredfrom[which(num_plays_complete$k3 == 3)]))
```

    ## 
    ##        Amazon 
    ##      1      1

``` r
#num_plays_complete[which(num_plays_complete$k3 == 3),]
```

K-means Clustering on Number of Plays Data Subset
=================================================

Similar to the kmeans clustering above, we use the number of clusters detected from the ward hierarchical model. Three clusters are initialized and plotted on two reduced dimensions. There is a little cluster overlap between cluster 2 and three here. We do not see the small cluster of 1 or 2 games like we have in previous models, but there are outliers in both cluster 1 and 3 that skew the clusters. These points seem to be farther from the centroid of their respective cluster. This model is less repeatable and several of the clusters changed when setting the seed differently. This produces less reliable clusters that, and this method seems like it would be less beneificial to for marketing purposes.

``` r
set.seed(1)

fit <- kmeans(play_cont_scale, 3)
fit         # print all available components
```

    ## K-means clustering with 3 clusters of sizes 26, 44, 18
    ## 
    ## Cluster means:
    ##       rating   numplays   baverage minplayers maxplayers playingtime
    ## 1 -1.0143569 -0.5299305 -1.0915634  0.1660257  0.4110131  -0.7277667
    ## 2  0.3980459 -0.3435721  0.4686161 -0.1529528 -0.1941083   0.4850976
    ## 3  0.4921811  1.6052982  0.4311967  0.1340697 -0.1191986  -0.1345755
    ## 
    ## Clustering vector:
    ##   1   2   3   4   5   7   8  11  15  19  20  22  23  29  30  32  33  34 
    ##   2   2   2   2   2   1   1   3   2   3   3   3   2   2   2   2   1   2 
    ##  36  37  38  39  40  42  43  44  45  47  48  51  53  54  56  57  58  59 
    ##   2   3   2   2   1   1   2   3   2   1   2   2   2   1   2   2   1   1 
    ##  60  61  62  64  65  66  68  69  73  74  76  77  80  81  83  84  85  87 
    ##   2   1   2   1   2   1   2   3   2   2   2   3   2   3   1   1   1   2 
    ##  88  92  96  97  98  99 100 101 102 103 105 107 109 110 113 114 115 117 
    ##   2   3   1   2   2   2   1   1   2   2   3   3   1   3   3   2   1   2 
    ## 122 127 130 143 144 145 147 148 149 151 153 157 162 164 165 167 
    ##   3   3   3   2   2   2   1   1   2   3   1   2   2   1   1   1 
    ## 
    ## Within cluster sum of squares by cluster:
    ## [1] 145.04162 117.60812  85.57091
    ##  (between_SS / total_SS =  33.3 %)
    ## 
    ## Available components:
    ## 
    ## [1] "cluster"      "centers"      "totss"        "withinss"    
    ## [5] "tot.withinss" "betweenss"    "size"         "iter"        
    ## [9] "ifault"

``` r
fit$center  # centers of each variable
```

    ##       rating   numplays   baverage minplayers maxplayers playingtime
    ## 1 -1.0143569 -0.5299305 -1.0915634  0.1660257  0.4110131  -0.7277667
    ## 2  0.3980459 -0.3435721  0.4686161 -0.1529528 -0.1941083   0.4850976
    ## 3  0.4921811  1.6052982  0.4311967  0.1340697 -0.1191986  -0.1345755

``` r
fit$cluster # cluster ID for each observation
```

    ##   1   2   3   4   5   7   8  11  15  19  20  22  23  29  30  32  33  34 
    ##   2   2   2   2   2   1   1   3   2   3   3   3   2   2   2   2   1   2 
    ##  36  37  38  39  40  42  43  44  45  47  48  51  53  54  56  57  58  59 
    ##   2   3   2   2   1   1   2   3   2   1   2   2   2   1   2   2   1   1 
    ##  60  61  62  64  65  66  68  69  73  74  76  77  80  81  83  84  85  87 
    ##   2   1   2   1   2   1   2   3   2   2   2   3   2   3   1   1   1   2 
    ##  88  92  96  97  98  99 100 101 102 103 105 107 109 110 113 114 115 117 
    ##   2   3   1   2   2   2   1   1   2   2   3   3   1   3   3   2   1   2 
    ## 122 127 130 143 144 145 147 148 149 151 153 157 162 164 165 167 
    ##   3   3   3   2   2   2   1   1   2   3   1   2   2   1   1   1

``` r
fviz_cluster(fit, data = play_cont_scale, palette = "Set2", ggtheme = theme_minimal())
```

![](Post_1_-_552_files/figure-markdown_github/Kmeans%20Number%20of%20Plays-1.png)

``` r
# Determine number of clusters with SSE
SSEs <- rep(NA,10) # a vector to store SSEs for different k's
SSEs[1] <- fit$totss # total SSE if no clustering is done
for(k in 2:10){
    fit <- kmeans(play_cont_scale,k)
    SSEs[k] <- fit$tot.withinss
}
par(mar=c(4,4,1,1))

plot(1:10,SSEs,type="b",xlab="Number of Clusters")
```

![](Post_1_-_552_files/figure-markdown_github/Kmeans%20Number%20of%20Plays-2.png)

Conclusion
==========

In conclusion, the hierarchical methods used for both data subsets could be used for marketing and cluster placement of new games. Based on cluster placement, consumers could be targeted who like similar games that fall within the same cluster. Besides pulling the data set from BoardGameGeek of ones own personal collection, you can pull everyones information who publically publishes their collection information. Using this large sample, targeting users who do not own the game yet, but may like the game would be a key technique.
